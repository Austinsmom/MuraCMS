!function(a){function r(r){r.stopPropagation?r.stopPropagation():a.event&&(a.event.cancelBubble=!0)}function t(a){a.dataTransfer.setData("Text",""),a.dataTransfer.dropEffect="copy",dragEl=this,elDropHandled=!1,newMuraObject=!1,muraLooseDropTarget=null}function e(){dragEl=null,elDropHandled=!1,newMuraObject=!1}function o(a){if(a.preventDefault(),a.dataTransfer.dropEffect="copy",dragEl||newMuraObject){var r=mura(".mura-var-target");muraLooseDropTarget=this,r.length&&(r.removeClass("mura-var-target"),r.attr("class")||r.removeAttr("class")),mura(this).addClass("mura-var-target")}}function n(a){mura(this).removeClass("mura-var-target"),muraLooseDropTarget=null,mura(this).attr("class")||mura(this).removeAttr("class")}function l(a){var t=mura(".mura-var-target").node;if(t&&(dragEl||newMuraObject)){if(dragEl&&dragEl!=this){if("container"==t.getAttribute("data-object")){var e=mura(t).children(".mura-content");if(!e.length)return;e.append(dragEl)}else t.parentNode.insertBefore(dragEl,t.nextSibling);mura("#adminSave").show(),mura(t).closest(".mura-region-local").data("dirty",!0),elDropHandled=!0,r(a)}else dragEl==t&&(elDropHandled=!0,r(a));f.call(t,a)}mura(".mura-var-target").removeClass("mura-var-target"),muraLooseDropTarget=null,newMuraObject=!1,mura(t).attr("class")||mura(t).removeAttr("class")}function u(a){mura(a).off("dragenter",t).off("dragover",o).off("drop",l).off("dragleave",n).on("dragstart",t).on("dragend",e).on("dragover",o).on("dragleave",n).on("drop",l).attr("draggable",!0)}function s(a){if(a.preventDefault(),a.dataTransfer.dropEffect="copy",!mura(".mura-var-target").length&&(dragEl||newMuraObject)){var r=mura(this).closest(".mura-object");r.length?r.addClass("mura-var-target"):mura(this).addClass("mura-var-target")}}function d(a){if(a.preventDefault(),dragEl||newMuraObject){var r=mura(".mura-var-target");muraLooseDropTarget=this,r.length&&(r.removeClass("mura-var-target"),r.attr("class")||r.removeAttr("class"));var t=mura(this).closest(".mura-object");t.length?t.addClass("mura-var-target"):mura(this).addClass("mura-var-target")}}function i(a){mura(this).removeClass("mura-var-target"),muraLooseDropTarget=null,mura(this).attr("class")||mura(this).removeAttr("class")}function c(a){if(r(a),dragEl||newMuraObject){var t=mura(".mura-var-target").node;if(t){if(dragEl&&dragEl!=t){if("container"==t.getAttribute("data-object")){var e=mura(t).children(".mura-content");e.append(dragEl)}else try{t.parentNode.insertBefore(dragEl,t.nextSibling)}catch(a){}mura("#adminSave").show(),mura(dragEl).addClass("mura-async-object"),mura(dragEl).data("async",!0),mura(t).closest(".mura-region-local").data("dirty",!0),u(t),elDropHandled=!0,r(a)}else dragEl==t&&(elDropHandled=!0,r(a));f.call(t,a)}}mura(".mura-var-target").removeClass("mura-var-target"),muraLooseDropTarget=null,newMuraObject=!1,mura(this).attr("class")||mura(this).removeAttr("class")}function m(a){mura(a).off("dragenter",s).off("dragover",d).off("drop",c).off("dragleave",i).on("dragenter",s).on("dragover",d).on("dragleave",i).on("drop",c)}function g(){mura(".mura-objectclass").each(function(){var a=mura(this);a.data("inited")||(a.attr("draggable",!0),a.on("dragstart",function(r){dragEl=null,elDropHandled=!1,newMuraObject=!0,muraLooseDropTarget=null,mura("#dragtype").html(a.data("object")),mura(".mura-sidebar").addClass("mura-sidebar--dragging"),r.dataTransfer.setData("text",JSON.stringify({object:a.data("object"),objectname:this.innerHTML,objectid:a.data("objectid")}))}).on("dragend",function(){mura("#dragtype").html(""),dragEl=null,elDropHandled=!1,newMuraObject=!1,mura(".mura-sidebar").removeClass("mura-sidebar--dragging")}),a.data("inited",!0))})}function f(a){a.preventDefault(),a.stopPropagation&&a.stopPropagation();var t=a.dataTransfer.getData("text");if(""!=t)try{t=JSON.parse(t)}catch(a){t=""}if("object"==typeof t&&t.object){var e=document.createElement("DIV");e.setAttribute("data-object",t.object),e.setAttribute("data-objectname",t.objectname),e.setAttribute("data-async",!0),e.setAttribute("data-perm","author"),e.setAttribute("data-instanceid",mura.createUUID()),e.setAttribute("class","mura-async-object mura-object active"),t.objectid?e.setAttribute("data-objectid",t.objectid):e.setAttribute("data-objectid",mura.createUUID());var o=mura(this);if(o.hasClass("mura-object"))if("container"==this.getAttribute("data-object")){var n=o.find(".mura-content");n.append(e)}else this.parentNode.insertBefore(e,this.nextSibling);else o.hasClass("mura-region-local")?this.appendChild(e):this.parentNode.insertBefore(e,this.nextSibling);u(e);var l=mura(e).data();muraInlineEditor.objectHasConfigurator(l)&&openFrontEndToolsModal(e),mura.processAsyncObject(e),mura(e).closest(".mura-region-local").data("dirty",!0),mura(e).on("dragover",function(){}),mura("#adminSave").show(),r(a)}}function p(a,r,t,e,o,n){var l="muraAction=cArch.loadclass&compactDisplay=true&layoutmanager=true&siteid="+a+"&classid="+r+"&subclassid="+t+"&contentid="+e+"&parentid="+o+"&cacheid="+Math.random();if(alert("test"),"plugins"==r)var u=mura("#pluginList");else{var u=mura("#classList");mura("#classListContainer").show()}return u.html(mura.preloaderMarkup),mura.ajax({url:mura.adminpath+"?"+l,success:function(a){u.html(a),g()}}),!1}function h(){g(),mura('.mura-region-local[data-inited="false"]').each(function(){var a=mura(this);(!a.data("loose")||a.data("loose")&&"<p></p>"==a.html()||""==mura.trim(a.html()))&&a.on("drop",function(a){var t,e,o;return a.preventDefault(),mura(this).find(".mura-object").length?void 0:(a.stopPropagation&&a.stopPropagation(),dragEl&&dragEl!==this?(t=this.parentNode,o=b(dragEl.parentNode.children).indexOf(dragEl),e=b(this.parentNode.children).indexOf(this),this.parentNode===dragEl.parentNode&&e>o?t.insertBefore(dragEl,this.nextSibling):this.appendChild(dragEl),mura("#adminSave").show(),mura(dragEl).data("async",!0),mura(dragEl).addClass("mura-async-object"),mura(this).data("dirty",!0),elDropHandled=!0,r(a)):dragEl==this&&(elDropHandled=!0,r(a)),f.call(this,a),muraLooseDropTarget=null,mura(".mura-var-target").removeClass("mura-var-target"),!0)}).on("dragover",function(a){a.preventDefault(),a.dataTransfer.dropEffect="copy"}).data("inited","true")}),mura(".mura-region-local .mura-object").each(function(){u(this)}),mura('div[data-object="container"], .mura-region-local div, .mura-region-local[data-loose="true"] p, .mura-region-local[data-loose="true"] h1, .mura-region-local[data-loose="true"] h2, .mura-region-local[data-loose="true"] h3, .mura-region-local[data-loose="true"] h4, .mura-region-local[data-loose="true"] img, .mura-region-local[data-loose="true"] table, .mura-region-local[data-loose="true"] article, .mura-region-local[data-loose="true"] dl').each(function(){m(this)})}var v,b=function(a,r,t){return Array.prototype.slice.call(a,r,t)},j;mura.initLayoutManager=h,mura.loadObjectClass=p}(window);